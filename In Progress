import gym
from stable_baselines3 import PPO

env = gym.make("ALE/SpaceInvaders-v5")
model = PPO('MlpPolicy', env, verbose=2)
env.reset()

class Agent():
    
	def train(self):
		model.learn(total_timesteps=1000000)
		model.save('./SI.h5')

	def test(self):
		episodes = 5
		for ep in range(episodes):
			obs = env.reset()
			done = False
			while not done:
				action, _states = model.predict(obs)
				obs, rewards, done, info = env.step(action)
				print(rewards)

if __name__ == "__main__":
    agent = Agent()
    agent.train()
    agent.test()
